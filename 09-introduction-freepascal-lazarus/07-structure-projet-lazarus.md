üîù Retour au [Sommaire](/SOMMAIRE.md)

# 9.7 Structure d'un projet Lazarus

## Introduction

Dans la section pr√©c√©dente, vous avez cr√©√© vos premiers projets avec Lazarus. Vous avez vu appara√Ætre plusieurs fichiers avec diff√©rentes extensions (.lpr, .lpi, .pas, .lfm...). Mais √† quoi servent exactement tous ces fichiers ? Comment sont-ils organis√©s ? Comment interagissent-ils ?

Cette section vous explique en d√©tail la structure d'un projet Lazarus. Comprendre cette structure est essentiel pour :
- Savoir quels fichiers sauvegarder
- Comprendre comment votre projet est organis√©
- Pouvoir partager votre code avec d'autres
- R√©soudre les probl√®mes de compilation
- Travailler en √©quipe sur un projet

**Ne vous inqui√©tez pas !** M√™me si cela semble technique, nous allons tout expliquer simplement, avec des exemples concrets.

## Vue d'ensemble : les deux types de projets

Lazarus peut cr√©er deux grands types de projets, avec des structures diff√©rentes.

### Projet simple (console)

Un programme console, comme notre "Hello World", est le plus simple :

```
HelloWorld/
  ‚îú‚îÄ‚îÄ HelloWorld.lpr         # Fichier source principal
  ‚îú‚îÄ‚îÄ HelloWorld.lps         # Session (optionnel)
  ‚îú‚îÄ‚îÄ lib/                   # Dossier de compilation
  ‚îÇ   ‚îî‚îÄ‚îÄ ...fichiers .o, .ppu...
  ‚îî‚îÄ‚îÄ HelloWorld.exe         # Ex√©cutable final (Windows)
      ou HelloWorld          # (Linux)
```

**Caract√©ristiques :**
- Un seul fichier source (.lpr)
- Pas de fichier projet (.lpi)
- Pas d'interface graphique

### Projet application (graphique)

Une application avec interface graphique est plus complexe :

```
MonAppli/
  ‚îú‚îÄ‚îÄ MonAppli.lpi           # Fichier projet (Project Information)
  ‚îú‚îÄ‚îÄ MonAppli.lpr           # Programme principal
  ‚îú‚îÄ‚îÄ MonAppli.lps           # Session
  ‚îú‚îÄ‚îÄ MonAppli.res           # Ressources (ic√¥ne, etc.)
  ‚îú‚îÄ‚îÄ unit1.pas              # Code du formulaire 1
  ‚îú‚îÄ‚îÄ unit1.lfm              # Description visuelle du formulaire 1
  ‚îú‚îÄ‚îÄ unit2.pas              # Code du formulaire 2 (si plusieurs)
  ‚îú‚îÄ‚îÄ unit2.lfm              # Description visuelle du formulaire 2
  ‚îú‚îÄ‚îÄ lib/                   # Dossier de compilation
  ‚îÇ   ‚îú‚îÄ‚îÄ x86_64-win64/      # Plateforme cible
  ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ unit1.o
  ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ unit1.ppu
  ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
  ‚îÇ   ‚îî‚îÄ‚îÄ ...
  ‚îú‚îÄ‚îÄ backup/                # Sauvegardes automatiques (optionnel)
  ‚îÇ   ‚îî‚îÄ‚îÄ ...
  ‚îî‚îÄ‚îÄ MonAppli.exe           # Ex√©cutable final
```

**Caract√©ristiques :**
- Fichier projet (.lpi) obligatoire
- Programme principal (.lpr)
- Une ou plusieurs unit√©s (.pas + .lfm)
- Fichiers de ressources (.res)
- Organisation plus structur√©e

## Les fichiers essentiels d'un projet

### 1. Le fichier .lpi (Lazarus Project Information)

**C'est le c≈ìur de votre projet !**

#### R√¥le et importance

Le fichier .lpi est un fichier **XML** qui contient toute la configuration de votre projet :
- La liste des fichiers sources
- Les options de compilation
- Les param√®tres de l'application (ic√¥ne, version, titre...)
- Les packages requis
- Les param√®tres de d√©bogage
- Les chemins de sortie

**Analogie :** C'est comme le "plan de montage" d'un meuble IKEA : il dit quelles pi√®ces utiliser et comment les assembler.

#### Contenu typique (simplifi√©)

```xml
<?xml version="1.0" encoding="UTF-8"?>
<CONFIG>
  <ProjectOptions>
    <Version Value="12"/>
    <General>
      <Title Value="MonAppli"/>
      <Icon Value="0"/>
    </General>
    <BuildModes Count="1">
      <Item1 Name="Default">
        <CompilerOptions>
          <Target>
            <Filename Value="MonAppli"/>
          </Target>
        </CompilerOptions>
      </Item1>
    </BuildModes>
    <Units Count="2">
      <Unit0>
        <Filename Value="MonAppli.lpr"/>
        <IsPartOfProject Value="True"/>
      </Unit0>
      <Unit1>
        <Filename Value="unit1.pas"/>
        <IsPartOfProject Value="True"/>
      </Unit1>
    </Units>
  </ProjectOptions>
</CONFIG>
```

**Points importants :**
- `<Title>` : nom de l'application
- `<Filename>` : nom de l'ex√©cutable
- `<Units>` : liste des fichiers du projet

#### Ouverture d'un projet

**Pour ouvrir un projet dans Lazarus :**
1. Menu **File** ‚Üí **Open Project...**
2. Naviguez vers votre dossier projet
3. **S√©lectionnez le fichier .lpi**
4. Cliquez **Ouvrir**

Lazarus charge alors automatiquement tous les fichiers associ√©s.

**‚ö†Ô∏è Important :** Ne modifiez JAMAIS le .lpi manuellement avec un √©diteur de texte ! Utilisez toujours Lazarus pour le g√©rer.

### 2. Le fichier .lpr (Lazarus Program)

**C'est le programme principal de votre application.**

#### R√¥le et importance

Le .lpr est le point d'entr√©e de votre programme. C'est le fichier qui contient le code principal qui sera ex√©cut√© au d√©marrage.

**Analogie :** C'est comme la fonction `main()` en C ou Java : tout commence ici.

#### Exemple pour un programme console

```pascal
program HelloWorld;

{$mode objfpc}{$H+}

uses
  SysUtils;

begin
  WriteLn('Hello World !');
  WriteLn('Appuyez sur Entr√©e...');
  ReadLn;
end.
```

**Structure :**
1. `program HelloWorld;` : d√©claration du nom du programme
2. `{$mode objfpc}{$H+}` : directives de compilation
3. `uses SysUtils;` : unit√©s utilis√©es
4. `begin...end.` : code principal

#### Exemple pour une application graphique

```pascal
program MonAppli;

{$mode objfpc}{$H+}

uses
  {$IFDEF UNIX}
  cthreads,
  {$ENDIF}
  Interfaces, // this includes the LCL widgetset
  Forms, unit1;

{$R *.res}

begin
  RequireDerivedFormResource := True;
  Application.Scaled := True;
  Application.Initialize;
  Application.CreateForm(TForm1, Form1);
  Application.Run;
end.
```

**Structure :**
1. `program MonAppli;` : nom du programme
2. `uses Interfaces, Forms, unit1;` : unit√©s n√©cessaires
3. `{$R *.res}` : inclusion des ressources
4. `Application.Initialize` : initialisation de l'application
5. `Application.CreateForm(TForm1, Form1);` : cr√©ation du formulaire principal
6. `Application.Run;` : lancement de la boucle d'√©v√©nements

**Note :** Pour les applications graphiques, Lazarus g√©n√®re et g√®re automatiquement ce fichier. Vous n'avez g√©n√©ralement pas besoin de le modifier.

#### Quand modifier le .lpr ?

**Rarement pour les applications graphiques !** Lazarus le g√®re.

**Pour les programmes console :** C'est l√† que vous √©crivez votre code principal.

**Modifications possibles (avanc√©) :**
- Ajouter du code d'initialisation global
- Configurer des options avant le lancement de l'application
- G√©rer des exceptions globales

### 3. Les fichiers .pas (Pascal Unit)

**Ce sont vos unit√©s de code : le "vrai" travail se fait ici !**

#### R√¥le et importance

Les fichiers .pas contiennent :
- Le code de vos formulaires
- Vos proc√©dures et fonctions personnalis√©es
- Vos classes et objets
- Vos types de donn√©es personnalis√©s
- La logique m√©tier de votre application

**Analogie :** C'est comme les chapitres d'un livre : chaque unit√© traite d'un sujet particulier.

#### Structure d'une unit√©

Chaque fichier .pas a toujours la m√™me structure en 3 parties :

```pascal
unit unit1;  // 1. En-t√™te : nom de l'unit√©

{$mode objfpc}{$H+}

// 2. INTERFACE : partie publique (visible de l'ext√©rieur)
interface

uses
  Classes, SysUtils, Forms, Controls, Graphics, Dialogs, StdCtrls;

type
  TForm1 = class(TForm)
    Button1: TButton;
    Label1: TLabel;
    procedure Button1Click(Sender: TObject);
  private
    // D√©clarations priv√©es (non visibles de l'ext√©rieur)
  public
    // D√©clarations publiques (visibles de l'ext√©rieur)
  end;

var
  Form1: TForm1;

// 3. IMPLEMENTATION : partie priv√©e (code r√©el)
implementation

{$R *.lfm}  // Charge le formulaire visuel

procedure TForm1.Button1Click(Sender: TObject);
begin
  ShowMessage('Bouton cliqu√© !');
end;

// 4. INITIALIZATION (optionnel)
initialization
  // Code ex√©cut√© au chargement de l'unit√©

// 5. FINALIZATION (optionnel)
finalization
  // Code ex√©cut√© √† la fermeture du programme

end.  // Fin de l'unit√© (notez le point !)
```

#### D√©tail des sections

**1. Interface (partie publique)**
- D√©clare ce qui est visible par les autres unit√©s
- Types, classes, proc√©dures, fonctions publiques
- Comme une "vitrine" : on voit ce qui est disponible

**2. Implementation (code r√©el)**
- Contient le code effectif des proc√©dures et fonctions
- Peut avoir des √©l√©ments priv√©s (non visibles de l'ext√©rieur)
- C'est ici que le travail est fait

**3. Initialization (optionnel)**
- Code ex√©cut√© automatiquement au chargement de l'unit√©
- Utilis√© pour initialiser des variables globales, charger des configurations, etc.

**4. Finalization (optionnel)**
- Code ex√©cut√© automatiquement √† la fermeture du programme
- Utilis√© pour lib√©rer des ressources, sauvegarder des donn√©es, etc.

#### Exemple concret : unit√© de calculs

```pascal
unit UnitCalculs;

{$mode objfpc}{$H+}

interface

uses
  SysUtils;

// Fonctions publiques (utilisables depuis d'autres unit√©s)
function Additionner(a, b: Integer): Integer;
function Multiplier(a, b: Integer): Integer;
function Diviser(a, b: Real): Real;

implementation

// Code des fonctions
function Additionner(a, b: Integer): Integer;
begin
  Result := a + b;
end;

function Multiplier(a, b: Integer): Integer;
begin
  Result := a * b;
end;

function Diviser(a, b: Real): Real;
begin
  if b = 0 then
    raise Exception.Create('Division par z√©ro !')
  else
    Result := a / b;
end;

end.
```

**Utilisation dans une autre unit√© :**

```pascal
unit unit1;

interface

uses
  UnitCalculs;  // On inclut notre unit√© de calculs

// ...

implementation

procedure TForm1.Button1Click(Sender: TObject);
var
  Resultat: Integer;
begin
  Resultat := Additionner(5, 3);  // Utilise la fonction de UnitCalculs
  ShowMessage('5 + 3 = ' + IntToStr(Resultat));
end;

end.
```

### 4. Les fichiers .lfm (Lazarus Form)

**C'est la description visuelle de vos formulaires.**

#### R√¥le et importance

Le fichier .lfm d√©crit la structure visuelle d'un formulaire :
- Position et taille de la fen√™tre
- Tous les composants (boutons, labels, etc.)
- Leurs propri√©t√©s (couleur, texte, taille...)
- Leurs positions relatives

**Important :** Le .lfm est li√© √† un fichier .pas du m√™me nom.
- `unit1.pas` ‚Üî `unit1.lfm`
- `FormPrincipal.pas` ‚Üî `FormPrincipal.lfm`

#### Format du fichier

Le .lfm est un fichier texte dans un format propri√©taire Lazarus (similaire au .dfm de Delphi).

**Exemple :**

```
object Form1: TForm1
  Left = 300
  Height = 400
  Top = 200
  Width = 600
  Caption = 'Ma Premi√®re Application'
  ClientHeight = 400
  ClientWidth = 600
  Color = clSkyBlue
  Position = poScreenCenter
  LCLVersion = '3.0.0.0'

  object Label1: TLabel
    Left = 150
    Height = 20
    Top = 50
    Width = 300
    Caption = 'Bienvenue dans mon application !'
    Font.Height = -16
    Font.Style = [fsBold]
  end

  object Button1: TButton
    Left = 220
    Height = 30
    Top = 150
    Width = 160
    Caption = 'Cliquez-moi !'
    OnClick = Button1Click
    TabOrder = 0
  end
end
```

**Lecture du fichier :**
- `object Form1: TForm1` : d√©but de la d√©finition du formulaire
- Propri√©t√©s du formulaire (Left, Height, Caption, Color...)
- Objets enfants (Label1, Button1) avec leurs propri√©t√©s
- `end` : fin de chaque objet

#### Lien avec le fichier .pas

Dans le fichier .pas correspondant, vous trouvez :

```pascal
{$R *.lfm}  // Cette directive charge le .lfm
```

Au d√©marrage, Lazarus :
1. Lit le fichier .lfm
2. Cr√©e les objets visuels d√©crits
3. Configure leurs propri√©t√©s
4. Les associe au code du .pas

**‚ö†Ô∏è Ne modifiez JAMAIS le .lfm manuellement !**
- Utilisez toujours le concepteur visuel de Lazarus
- Modifications manuelles = risque de corruption
- Lazarus g√®re automatiquement ce fichier

### 5. Le fichier .lps (Lazarus Project Session)

**C'est la m√©morisation de votre session de travail.**

#### R√¥le et importance

Le .lps sauvegarde :
- Quels fichiers √©taient ouverts
- Position du curseur dans chaque fichier
- Points d'arr√™t (breakpoints) du d√©bogueur
- Fen√™tres ouvertes/ferm√©es
- Disposition de l'espace de travail

**Analogie :** C'est comme les onglets ouverts dans votre navigateur : √ßa vous permet de reprendre o√π vous vous √™tes arr√™t√©.

#### Caract√©ristiques

**Format :** XML (similaire au .lpi)

**Contenu typique :**

```xml
<?xml version="1.0" encoding="UTF-8"?>
<CONFIG>
  <ProjectSession>
    <Version Value="12"/>
    <Units Count="2">
      <Unit0>
        <Filename Value="MonAppli.lpr"/>
        <IsPartOfProject Value="True"/>
        <EditorIndex Value="1"/>
        <CursorPos X="15" Y="18"/>
        <UsageCount Value="25"/>
      </Unit0>
      <Unit1>
        <Filename Value="unit1.pas"/>
        <IsPartOfProject Value="True"/>
        <IsVisibleTab Value="True"/>
        <EditorIndex Value="0"/>
        <TopLine Value="15"/>
        <CursorPos X="8" Y="32"/>
        <UsageCount Value="25"/>
      </Unit1>
    </Units>
  </ProjectSession>
</CONFIG>
```

**Informations sauvegard√©es :**
- Fichiers ouverts dans l'√©diteur
- Position du curseur (ligne, colonne)
- Ligne visible en haut de l'√©diteur
- Onglet actif

#### Faut-il sauvegarder le .lps ?

**Non, pas n√©cessaire !**

**Avantages de le sauvegarder :**
- ‚úÖ Garde votre espace de travail personnel
- ‚úÖ Reprend exactement o√π vous √©tiez

**Inconv√©nients :**
- ‚ùå Sp√©cifique √† votre machine
- ‚ùå Peut causer des conflits en √©quipe
- ‚ùå Lazarus le recr√©e automatiquement

**Recommandation :**
- Travail solo : sauvegardez si vous voulez
- Travail en √©quipe : ajoutez `.lps` au `.gitignore`
- Si absent : Lazarus en cr√©e un nouveau automatiquement

### 6. Le fichier .res (Resources)

**Contient les ressources binaires de l'application.**

#### R√¥le et importance

Le fichier .res contient des ressources embarqu√©es :
- **Ic√¥ne de l'application** (visible dans la barre des t√¢ches)
- Manifest Windows (informations sur l'application)
- Version de l'application
- Autres ressources binaires (images, sons...)

**Pour les applications graphiques :** Lazarus cr√©e automatiquement ce fichier.

#### Contenu typique

```
{$R *.res}
```

Cette directive dans le .lpr indique d'inclure le fichier .res.

**Le fichier .res est binaire**, vous ne pouvez pas l'ouvrir avec un √©diteur de texte.

#### Personnaliser l'ic√¥ne de l'application

**M√©thode 1 : Via les options du projet**
1. Menu **Project** ‚Üí **Project Options**
2. Section **Application** ‚Üí **Icon**
3. Cliquez sur **Load Icon**
4. S√©lectionnez votre fichier .ico
5. Cliquez **OK**
6. Recompilez (F9)

**M√©thode 2 : Via le Project Inspector**
1. Menu **View** ‚Üí **Project Inspector**
2. Double-cliquez sur le fichier .res
3. Un √©diteur de ressources s'ouvre
4. Modifiez l'ic√¥ne

**Format de l'ic√¥ne :**
- Windows : fichier .ico (16√ó16, 32√ó32, 48√ó48 pixels)
- Linux : fichier .png ou .xpm

## Les dossiers d'un projet

### 1. Le dossier lib/

**Contient les fichiers temporaires de compilation.**

#### Contenu

```
lib/
  ‚îú‚îÄ‚îÄ x86_64-win64/         # Plateforme cible (exemple : Windows 64 bits)
  ‚îÇ   ‚îú‚îÄ‚îÄ unit1.o           # Fichier objet (code compil√©)
  ‚îÇ   ‚îú‚îÄ‚îÄ unit1.ppu         # Pascal Precompiled Unit
  ‚îÇ   ‚îú‚îÄ‚îÄ MonAppli.res      # Ressources compil√©es
  ‚îÇ   ‚îî‚îÄ‚îÄ ...
  ‚îú‚îÄ‚îÄ x86_64-linux/         # Autre plateforme (si compilation crois√©e)
  ‚îÇ   ‚îî‚îÄ‚îÄ ...
  ‚îî‚îÄ‚îÄ ...
```

**Types de fichiers :**

| Extension | Description |
|-----------|-------------|
| **.o** | Fichier objet : code machine interm√©diaire |
| **.ppu** | Pascal Precompiled Unit : unit√© pr√©compil√©e |
| **.compiled** | Marque de compilation r√©ussie |
| **.res** | Ressources compil√©es |
| **.or** | Fichier objet pour les ressources |

**Organisation :**
- Un sous-dossier par plateforme cible
- Exemples : `x86_64-win64`, `i386-linux`, `arm-android`

#### Peut-on supprimer lib/ ?

**Oui, sans probl√®me !**

- Ces fichiers seront recr√©√©s √† la prochaine compilation
- Utile pour "nettoyer" un projet
- Gain d'espace disque (lib/ peut √™tre volumineux)

**Comment nettoyer :**
1. Menu **Run** ‚Üí **Clean up and Build**
2. Ou supprimer manuellement le dossier lib/

**Quand nettoyer :**
- Erreurs de compilation myst√©rieuses
- Changement d'options de compilation
- Avant de partager le projet (r√©duit la taille)

### 2. Le dossier backup/

**Sauvegardes automatiques des fichiers modifi√©s.**

#### R√¥le

Lazarus peut sauvegarder automatiquement vos fichiers avant modification.

**Configuration :**
1. Menu **Tools** ‚Üí **Options**
2. Section **Environment** ‚Üí **Backup**
3. Cochez **Create backup of files**
4. Choisissez le sous-dossier : `backup/` (recommand√©)

#### Contenu

```
backup/
  ‚îú‚îÄ‚îÄ unit1.pas.bak
  ‚îú‚îÄ‚îÄ unit1.lfm.bak
  ‚îú‚îÄ‚îÄ MonAppli.lpr.bak
  ‚îî‚îÄ‚îÄ ...
```

Chaque fichier sauvegard√© a l'extension `.bak` ajout√©e.

#### Utilisation

**Pour restaurer un fichier :**
1. Allez dans `backup/`
2. Renommez `unit1.pas.bak` en `unit1.pas`
3. Remplacez le fichier actuel (attention, sauvegardez-le d'abord !)

**Avantages :**
- Protection contre les erreurs
- Annulation de modifications importantes
- Historique limit√© des changements

**Inconv√©nients :**
- Prend de l'espace disque
- Pas aussi sophistiqu√© qu'un vrai syst√®me de versions (Git)

**Recommandation :**
- Activez les backups pour d√©buter
- Plus tard, passez √† Git pour un vrai versioning

### 3. Autres dossiers (avanc√©)

**docs/** : Documentation du projet
**images/** : Images, ic√¥nes pour l'interface
**data/** : Fichiers de donn√©es (configuration, bases de donn√©es...)
**tests/** : Tests unitaires (FPCUnit)

**Organisation personnelle :** Vous pouvez cr√©er vos propres dossiers selon vos besoins.

## Hi√©rarchie et d√©pendances

### D√©pendances entre fichiers

**Ordre d'importance :**

```
.lpi (Fichier projet)
  ‚Üì
.lpr (Programme principal)
  ‚Üì
.pas (Unit√©s de code)
  ‚Üì
.lfm (Formulaires visuels)
```

**Le .lpi coordonne tout :**
- Liste tous les fichiers du projet
- D√©finit l'ordre de compilation
- Configure les options

**Le .lpr d√©marre l'application :**
- Point d'entr√©e du programme
- Initialise l'application
- Cr√©e les formulaires

**Les .pas contiennent la logique :**
- Code m√©tier
- Gestionnaires d'√©v√©nements
- Fonctions et proc√©dures

**Les .lfm d√©finissent l'apparence :**
- Structure visuelle
- Propri√©t√©s des composants
- Li√©s aux .pas correspondants

### Clause uses : g√©rer les d√©pendances

**Dans chaque unit√© .pas, la clause `uses` liste les unit√©s n√©cessaires :**

```pascal
unit unit1;

interface

uses
  Classes, SysUtils, Forms, Controls, Graphics, Dialogs, StdCtrls;
```

**Unit√©s standards courantes :**

| Unit√© | Contenu |
|-------|---------|
| **Classes** | Listes, streams, classes de base |
| **SysUtils** | Fonctions syst√®me, manipulation de cha√Ænes, dates |
| **Forms** | Formulaires et applications graphiques |
| **Controls** | Contr√¥les de base (TControl) |
| **Graphics** | Dessin, couleurs, polices |
| **Dialogs** | Bo√Ætes de dialogue standard |
| **StdCtrls** | Contr√¥les standard (boutons, labels...) |
| **ExtCtrls** | Contr√¥les √©tendus (panels, timers...) |

**Unit√©s personnalis√©es :**

```pascal
uses
  unit1, UnitCalculs, UnitBaseDonnees;
```

**Ordre d'importance :**
1. Unit√©s syst√®me d'abord
2. Puis unit√©s LCL
3. Enfin unit√©s personnalis√©es

**‚ö†Ô∏è Attention aux d√©pendances circulaires !**

**Exemple de probl√®me :**
```pascal
// unit1.pas
uses unit2;

// unit2.pas
uses unit1;  // Erreur : d√©pendance circulaire !
```

**Solution :** Utiliser la section `implementation` pour les d√©pendances secondaires :

```pascal
// unit1.pas
interface
uses Classes;

implementation
uses unit2;  // OK : dans implementation seulement
```

## Organisation d'un projet multi-formulaires

Pour une application avec plusieurs fen√™tres :

```
MonGrandeAppli/
  ‚îú‚îÄ‚îÄ MonGrandeAppli.lpi
  ‚îú‚îÄ‚îÄ MonGrandeAppli.lpr
  ‚îú‚îÄ‚îÄ MonGrandeAppli.res
  ‚îÇ
  ‚îú‚îÄ‚îÄ FormPrincipal.pas          # Formulaire principal
  ‚îú‚îÄ‚îÄ FormPrincipal.lfm
  ‚îÇ
  ‚îú‚îÄ‚îÄ FormOptions.pas            # Fen√™tre d'options
  ‚îú‚îÄ‚îÄ FormOptions.lfm
  ‚îÇ
  ‚îú‚îÄ‚îÄ FormAPropos.pas            # Fen√™tre "√Ä propos"
  ‚îú‚îÄ‚îÄ FormAPropos.lfm
  ‚îÇ
  ‚îú‚îÄ‚îÄ UnitBaseDonnees.pas        # Unit√© pour la BD (sans formulaire)
  ‚îú‚îÄ‚îÄ UnitCalculs.pas            # Unit√© de calculs (sans formulaire)
  ‚îÇ
  ‚îî‚îÄ‚îÄ lib/
```

**Programme principal (.lpr) :**

```pascal
program MonGrandeAppli;

uses
  Interfaces, Forms,
  FormPrincipal,      // Formulaire principal
  FormOptions,        // Autres formulaires
  FormAPropos,
  UnitBaseDonnees,    // Unit√©s sans interface
  UnitCalculs;

begin
  Application.Initialize;
  Application.CreateForm(TFormPrincipal, FormPrincipal);  // Cr√©ation du form principal
  Application.Run;
end.
```

**Notes :**
- Le formulaire principal est cr√©√© avec `CreateForm`
- Les autres formulaires sont cr√©√©s √† la demande dans le code
- Les unit√©s sans interface sont juste list√©es dans `uses`

## Fichiers √† sauvegarder et partager

### Fichiers essentiels (INDISPENSABLES)

‚úÖ √Ä sauvegarder absolument :

| Fichier | Pourquoi |
|---------|----------|
| **.lpi** | Configuration du projet |
| **.lpr** | Programme principal |
| **.pas** | Tout votre code |
| **.lfm** | Structure des formulaires |
| **.res** | Ressources (ic√¥ne...) |

**Sans ces fichiers, votre projet ne peut pas √™tre recompil√© !**

### Fichiers optionnels

üî∂ Peuvent √™tre sauvegard√©s :

| Fichier | Utilit√© |
|---------|---------|
| **.lps** | Session de travail personnelle |
| **backup/** | Sauvegardes automatiques |
| **README.md** | Documentation du projet |

### Fichiers √† ne PAS sauvegarder

‚ùå Ne sauvegardez pas (seront recr√©√©s) :

| Fichier/Dossier | Raison |
|-----------------|--------|
| **lib/** | Fichiers de compilation temporaires |
| **.exe** / ex√©cutable | R√©sultat de la compilation |
| **.o, .ppu** | Fichiers objets temporaires |
| **.compiled** | Marque de compilation |

**Avantage :** √âconomise beaucoup d'espace !

### Utiliser un fichier .gitignore (avanc√©)

Si vous utilisez Git pour le versioning :

**.gitignore :**
```
# Fichiers de compilation
lib/
*.exe
*.o
*.ppu
*.compiled
*.or

# Session
*.lps

# Backup
backup/

# Fichiers temporaires
*~
*.bak
*.tmp
```

## Comprendre la compilation : du code au programme

### Processus de compilation

**√âtape 1 : Analyse syntaxique**
- Lazarus lit les fichiers .pas
- V√©rifie la syntaxe (begin/end, point-virgules...)
- Construit un arbre syntaxique

**√âtape 2 : Compilation**
- Transformation du Pascal en code machine
- Cr√©ation des fichiers .o (fichiers objets)
- Chaque unit√© .pas ‚Üí un fichier .o

**√âtape 3 : Linking (√©dition de liens)**
- Rassemblement de tous les .o
- Ajout des biblioth√®ques syst√®me
- Inclusion des ressources (.res, .lfm)
- Cr√©ation de l'ex√©cutable final

**R√©sultat :** Un fichier .exe (Windows) ou un ex√©cutable (Linux) pr√™t √† l'emploi.

### Ordre de compilation

Lazarus compile dans cet ordre :

1. **Unit√©s sans d√©pendances** en premier
2. **Unit√©s avec d√©pendances** ensuite (selon la clause `uses`)
3. **Programme principal** (.lpr) en dernier

**Exemple :**
```
UnitCalculs (pas de d√©pendance)
  ‚Üì
UnitBaseDonnees (utilise UnitCalculs)
  ‚Üì
unit1 (utilise UnitCalculs et UnitBaseDonnees)
  ‚Üì
MonAppli.lpr (utilise unit1)
```

**Lazarus d√©termine automatiquement l'ordre** en analysant les clauses `uses`.

### Modes de compilation

**Debug (par d√©faut pour d√©veloppement)**
- Informations de d√©bogage incluses
- Optimisations d√©sactiv√©es
- Fichier plus gros, mais d√©bogage possible
- Performance r√©duite

**Release (pour distribution)**
- Pas d'informations de d√©bogage
- Optimisations activ√©es
- Fichier plus petit
- Performance maximale
- Pas de d√©bogage possible

**Configuration :**
1. Menu **Project** ‚Üí **Project Options**
2. Section **Compiler Options**
3. Modes de build : **Debug** ou **Release**

## Bonnes pratiques d'organisation

### 1. Un dossier = un projet

**Toujours cr√©er un dossier d√©di√© pour chaque projet !**

‚úÖ Bon :
```
MesProjets/
  ‚îú‚îÄ‚îÄ Calculatrice/
  ‚îÇ   ‚îî‚îÄ‚îÄ ...tous les fichiers de la calculatrice...
  ‚îú‚îÄ‚îÄ JeuMemoire/
  ‚îÇ   ‚îî‚îÄ‚îÄ ...tous les fichiers du jeu...
  ‚îî‚îÄ‚îÄ GestionContacts/
      ‚îî‚îÄ‚îÄ ...tous les fichiers de gestion...
```

‚ùå Mauvais :
```
MesProjets/
  ‚îú‚îÄ‚îÄ calculatrice.lpi
  ‚îú‚îÄ‚îÄ unit1.pas
  ‚îú‚îÄ‚îÄ jeu.lpi
  ‚îú‚îÄ‚îÄ unit1.pas  ‚Üê Conflit de noms !
  ‚îî‚îÄ‚îÄ ...
```

### 2. Noms de fichiers clairs

**Donnez des noms descriptifs :**

‚úÖ Bon :
- `FormPrincipal.pas` / `FormPrincipal.lfm`
- `FormOptions.pas` / `FormOptions.lfm`
- `UnitBaseDonnees.pas`
- `UnitCalculs.pas`

‚ùå Mauvais :
- `unit1.pas` / `unit1.lfm`
- `unit2.pas` / `unit2.lfm`
- `tmp.pas`

**Comment renommer :**
1. Fermez le projet dans Lazarus
2. Renommez les fichiers .pas ET .lfm ensemble
3. √âditez le .lpi pour corriger les r√©f√©rences
4. R√©ouvrez le projet

**Plus simple :** Renommez d√®s la cr√©ation !

### 3. Commentaires dans le code

**Documentez chaque unit√© :**

```pascal
unit UnitCalculs;

{*****************************************************************************
 * UnitCalculs.pas
 *
 * Description : Fonctions math√©matiques pour l'application
 * Auteur : Votre Nom
 * Date cr√©ation : 15/01/2025
 * Derni√®re modification : 15/01/2025
 *
 * Fonctions principales :
 *   - Additionner : addition de deux nombres
 *   - Multiplier : multiplication de deux nombres
 *   - Diviser : division avec gestion de la division par z√©ro
 ****************************************************************************}

{$mode objfpc}{$H+}

interface

// Reste du code...
```

### 4. Organiser avec des sous-dossiers (projets avanc√©s)

Pour les grands projets :

```
MonGrosProjet/
  ‚îú‚îÄ‚îÄ MonGrosProjet.lpi
  ‚îú‚îÄ‚îÄ MonGrosProjet.lpr
  ‚îÇ
  ‚îú‚îÄ‚îÄ src/                    # Code source
  ‚îÇ   ‚îú‚îÄ‚îÄ forms/              # Tous les formulaires
  ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FormPrincipal.*
  ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FormOptions.*
  ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
  ‚îÇ   ‚îú‚îÄ‚îÄ units/              # Unit√©s m√©tier
  ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ UnitBaseDonnees.pas
  ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UnitCalculs.pas
  ‚îÇ   ‚îî‚îÄ‚îÄ classes/            # Classes personnalis√©es
  ‚îÇ       ‚îî‚îÄ‚îÄ ...
  ‚îÇ
  ‚îú‚îÄ‚îÄ resources/              # Ressources
  ‚îÇ   ‚îú‚îÄ‚îÄ images/
  ‚îÇ   ‚îú‚îÄ‚îÄ icons/
  ‚îÇ   ‚îî‚îÄ‚îÄ data/
  ‚îÇ
  ‚îú‚îÄ‚îÄ docs/                   # Documentation
  ‚îÇ   ‚îî‚îÄ‚îÄ README.md
  ‚îÇ
  ‚îî‚îÄ‚îÄ lib/                    # Compilation
```

**Note :** N√©cessite de configurer les chemins dans les options du projet.

### 5. Versioning avec Git (recommand√©)

**Git permet de :**
- Sauvegarder l'historique des modifications
- Travailler en √©quipe
- Revenir √† une version ant√©rieure
- G√©rer les branches de d√©veloppement

**Fichiers √† suivre :**
```bash
git add *.lpi *.lpr *.pas *.lfm *.res README.md
git commit -m "Version initiale"
```

**Fichiers √† ignorer :** Voir le .gitignore plus haut.

## Conclusion

Vous comprenez maintenant en profondeur la structure d'un projet Lazarus ! Cette connaissance est fondamentale pour travailler efficacement.

**Ce que vous avez appris dans cette section :**
- ‚úÖ R√¥le et contenu de chaque type de fichier (.lpi, .lpr, .pas, .lfm, .lps, .res)
- ‚úÖ Organisation des dossiers (lib/, backup/)
- ‚úÖ Hi√©rarchie et d√©pendances entre fichiers
- ‚úÖ Processus de compilation du code au programme
- ‚úÖ Fichiers essentiels vs fichiers temporaires
- ‚úÖ Bonnes pratiques d'organisation
- ‚úÖ Gestion des d√©pendances (clause uses)
- ‚úÖ Organisation de projets multi-formulaires

**Comp√©tences acquises :**
- Savoir quels fichiers sauvegarder
- Comprendre les messages de compilation
- Organiser proprement vos projets
- Travailler avec plusieurs unit√©s
- Nettoyer et maintenir un projet

**Points cl√©s √† retenir :**
- **Le .lpi est le c≈ìur du projet** : c'est lui qu'on ouvre dans Lazarus
- **Le .lpr est le point d'entr√©e** : le programme commence ici
- **Les .pas contiennent votre code** : c'est l√† que vous travaillez
- **Les .lfm sont g√©n√©r√©s automatiquement** : ne les modifiez jamais manuellement
- **Le dossier lib/ peut √™tre supprim√©** : il sera recr√©√© √† la compilation
- **Un projet = un dossier d√©di√©** : r√®gle d'or de l'organisation

**Prochaines √©tapes :**
- Section 9.8 : Configuration avanc√©e de Lazarus
- Section 9.9 : Ma√Ætriser la compilation et l'ex√©cution
- Section 9.10 : Utiliser l'aide et la documentation

**Conseil pratique :** Prenez le temps d'explorer vos propres projets avec ces nouvelles connaissances. Ouvrez les fichiers, regardez leur contenu, exp√©rimentez !

---

**En r√©sum√© :**
- `.lpi` = configuration du projet (XML)
- `.lpr` = programme principal (code Pascal)
- `.pas` = unit√©s de code (votre travail)
- `.lfm` = description des formulaires (g√©n√©r√© automatiquement)
- `.lps` = session (optionnel, peut √™tre ignor√©)
- `.res` = ressources (ic√¥ne, manifest...)
- `lib/` = compilation temporaire (peut √™tre supprim√©)
- `backup/` = sauvegardes automatiques (optionnel)

‚è≠Ô∏è [Compilation et ex√©cution](/09-introduction-freepascal-lazarus/08-compilation-execution.md)
